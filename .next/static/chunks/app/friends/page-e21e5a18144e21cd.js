(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[89],{6141:function(e,s,a){"use strict";a.d(s,{Z:function(){return i}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let i=(0,a(2898).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},1827:function(e,s,a){"use strict";a.d(s,{Z:function(){return i}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let i=(0,a(2898).Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},2851:function(e,s,a){"use strict";a.d(s,{Z:function(){return i}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let i=(0,a(2898).Z)("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]])},5750:function(e,s,a){"use strict";a.d(s,{Z:function(){return i}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let i=(0,a(2898).Z)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])},8595:function(e,s,a){Promise.resolve().then(a.bind(a,8387))},8387:function(e,s,a){"use strict";a.r(s),a.d(s,{FriendsManager:function(){return b}});var i=a(7437),r=a(2265),t=a(5251),l=a(5750),n=a(6141),c=a(2851),d=a(1827),m=a(7810),o=a(2176),u=a(7472),x=a(2898);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let h=(0,x.Z)("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]),y=(0,x.Z)("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]);var p=a(4527),f=a(575),g=a(3277),v=a(5808),j=a(9497),N=a(2426),k=a(1097),_=a(2169);function b(e){let{user:s}=e,[a,x]=(0,r.useState)([]),[b,w]=(0,r.useState)([]),[q,Z]=(0,r.useState)([]),[C,z]=(0,r.useState)(""),[E,S]=(0,r.useState)(!0),[M,A]=(0,r.useState)(null),{toast:L}=(0,N.useToast)();(0,r.useEffect)(()=>{O(),Q(),U(),H()},[s.id]);let O=async()=>{try{let{data:e,error:a}=await k.OQ.from("profiles").select("*").eq("id",s.id).single();if(a)throw a;A(e)}catch(e){console.error("Error loading current user profile:",e)}},Q=async()=>{try{let{data:e,error:a}=await k.OQ.from("friendships").select("\n          id,\n          status,\n          created_at,\n          requester:profiles!friendships_requester_id_fkey (\n            id,\n            username,\n            display_name,\n            avatar_url,\n            school,\n            grade,\n            city,\n            interests,\n            level,\n            last_active\n          ),\n          addressee:profiles!friendships_addressee_id_fkey (\n            id,\n            username,\n            display_name,\n            avatar_url,\n            school,\n            grade,\n            city,\n            interests,\n            level,\n            last_active\n          )\n        ").or("requester_id.eq.".concat(s.id,",addressee_id.eq.").concat(s.id)).eq("status","accepted");if(a)throw a;let i=(null==e?void 0:e.map(e=>{var a;return{...(null===(a=e.requester)||void 0===a?void 0:a.id)===(null==s?void 0:s.id)?e.addressee:e.requester,friendship_id:e.id,friendship_status:e.status,friendship_created_at:e.created_at}}))||[];M&&i.forEach(e=>{e.compatibility_score=(0,_.g)(M.interests||[],e.interests||[])}),x(i)}catch(e){console.error("Error loading friends:",e)}},U=async()=>{try{let{data:e,error:a}=await k.OQ.from("friendships").select("\n          id,\n          requester_id,\n          addressee_id,\n          created_at,\n          requester:profiles!friendships_requester_id_fkey (\n            username,\n            display_name,\n            avatar_url,\n            school,\n            grade,\n            interests,\n            level\n          )\n        ").eq("addressee_id",s.id).eq("status","pending");if(a)throw a;w(e||[])}catch(e){console.error("Error loading friend requests:",e)}},H=async()=>{try{let{data:e,error:i}=await k.OQ.from("profiles").select("*").neq("id",s.id).limit(10);if(i)throw i;let r=a.map(e=>e.id),t=b.map(e=>e.requester_id),l=(null==e?void 0:e.filter(e=>!r.includes(e.id)&&!t.includes(e.id)))||[];M&&(l.forEach(e=>{e.compatibility_score=(0,_.g)(M.interests||[],e.interests||[])}),l.sort((e,s)=>(s.compatibility_score||0)-(e.compatibility_score||0))),Z(l.slice(0,6))}catch(e){console.error("Error loading suggestions:",e)}finally{S(!1)}},P=async(e,a)=>{try{if("send"===a){let{error:a}=await k.OQ.from("friendships").insert({requester_id:s.id,addressee_id:e,status:"pending"});if(a)throw a;L({title:"Arkadaşlık isteği g\xf6nderildi!",type:"success"}),H()}else if("accept"===a){let{error:a}=await k.OQ.from("friendships").update({status:"accepted"}).eq("requester_id",e).eq("addressee_id",s.id);if(a)throw a;L({title:"Arkadaşlık isteği kabul edildi!",type:"success"}),Q(),U()}else if("reject"===a){let{error:a}=await k.OQ.from("friendships").delete().eq("requester_id",e).eq("addressee_id",s.id);if(a)throw a;L({title:"Arkadaşlık isteği reddedildi.",type:"success"}),U()}}catch(e){console.error("Error handling friend request:",e),L({title:"Bir hata oluştu",description:"L\xfctfen tekrar deneyin.",type:"error"})}},Y=async e=>{try{let{error:s}=await k.OQ.from("friendships").delete().eq("id",e);if(s)throw s;L({title:"Arkadaş silindi.",type:"success"}),Q()}catch(e){console.error("Error removing friend:",e),L({title:"Bir hata oluştu",description:"L\xfctfen tekrar deneyin.",type:"error"})}},B=a.filter(e=>e.display_name.toLowerCase().includes(C.toLowerCase())||e.username.toLowerCase().includes(C.toLowerCase())),F=e=>e>=80?"text-green-600 bg-green-100":e>=60?"text-blue-600 bg-blue-100":e>=40?"text-yellow-600 bg-yellow-100":"text-gray-600 bg-gray-100";return E?(0,i.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[...Array(6)].map((e,s)=>(0,i.jsx)("div",{className:"card p-6",children:(0,i.jsxs)("div",{className:"flex items-center space-x-4 mb-4",children:[(0,i.jsx)("div",{className:"w-12 h-12 bg-gray-200 rounded-full animate-pulse"}),(0,i.jsxs)("div",{className:"flex-1",children:[(0,i.jsx)("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-2 animate-pulse"}),(0,i.jsx)("div",{className:"h-3 bg-gray-200 rounded w-1/2 animate-pulse"})]})]})},s))}):(0,i.jsxs)(j.mQ,{defaultValue:"friends",className:"space-y-6",children:[(0,i.jsxs)(j.dr,{className:"grid w-full grid-cols-3",children:[(0,i.jsxs)(j.SP,{value:"friends",className:"flex items-center",children:[(0,i.jsx)(l.Z,{className:"h-4 w-4 mr-2"}),"Arkadaşlar (",a.length,")"]}),(0,i.jsxs)(j.SP,{value:"requests",className:"flex items-center",children:[(0,i.jsx)(n.Z,{className:"h-4 w-4 mr-2"}),"İstekler (",b.length,")"]}),(0,i.jsxs)(j.SP,{value:"suggestions",className:"flex items-center",children:[(0,i.jsx)(c.Z,{className:"h-4 w-4 mr-2"}),"\xd6neriler"]})]}),(0,i.jsxs)(j.nU,{value:"friends",className:"space-y-6",children:[(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)(d.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,i.jsx)("input",{type:"text",placeholder:"Arkadaş ara...",value:C,onChange:e=>z(e.target.value),className:"input pl-10 w-full max-w-md"})]}),(0,i.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:B.map(e=>{var s;return(0,i.jsxs)(t.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"card p-6",children:[(0,i.jsxs)("div",{className:"flex items-center space-x-4 mb-4",children:[(0,i.jsx)(v.q,{src:e.avatar_url,alt:e.display_name,fallback:null===(s=e.username[0])||void 0===s?void 0:s.toUpperCase(),size:"lg"}),(0,i.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,i.jsx)("h3",{className:"font-semibold text-gray-900 truncate",children:e.display_name}),(0,i.jsxs)("p",{className:"text-sm text-gray-500",children:["@",e.username]}),(0,i.jsx)("div",{className:"flex items-center mt-1",children:(0,i.jsxs)(g.C,{variant:"outline",className:"text-xs",children:["Seviye ",e.level]})})]})]}),e.compatibility_score&&e.compatibility_score>0&&(0,i.jsxs)("div",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium mb-3 ".concat(F(e.compatibility_score)),children:[(0,i.jsx)(m.Z,{className:"h-3 w-3 mr-1"}),"%",e.compatibility_score," uyumlu"]}),(0,i.jsxs)("div",{className:"space-y-2 text-sm text-gray-600 mb-4",children:[e.school&&(0,i.jsx)("div",{children:e.school}),e.city&&(0,i.jsx)("div",{children:e.city}),(0,i.jsxs)("div",{className:"text-xs",children:["Son g\xf6r\xfclme: ",(0,_.SY)(e.last_active)]})]}),(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsxs)(f.z,{size:"sm",variant:"outline",className:"flex-1",children:[(0,i.jsx)(o.Z,{className:"h-3 w-3 mr-1"}),"Mesaj"]}),(0,i.jsx)(f.z,{size:"sm",variant:"ghost",onClick:()=>Y(e.friendship_id),children:(0,i.jsx)(u.Z,{className:"h-4 w-4"})})]})]},e.id)})}),0===B.length&&(0,i.jsxs)("div",{className:"text-center py-12",children:[(0,i.jsx)(l.Z,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,i.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:C?"Arkadaş bulunamadı":"Hen\xfcz arkadaşın yok"}),(0,i.jsx)("p",{className:"text-gray-600 mb-4",children:C?"Arama kriterlerine uygun arkadaş bulunamadı.":"Yeni arkadaşlar edinmek i\xe7in \xf6neriler sekmesini kontrol et!"}),!C&&(0,i.jsx)(f.z,{asChild:!0,children:(0,i.jsx)("a",{href:"#suggestions",children:"\xd6nerileri G\xf6r"})})]})]}),(0,i.jsxs)(j.nU,{value:"requests",className:"space-y-6",children:[(0,i.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:b.map(e=>{var s;return(0,i.jsxs)(t.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"card p-6",children:[(0,i.jsxs)("div",{className:"flex items-center space-x-4 mb-4",children:[(0,i.jsx)(v.q,{src:e.requester.avatar_url,alt:e.requester.display_name,fallback:null===(s=e.requester.username[0])||void 0===s?void 0:s.toUpperCase(),size:"lg"}),(0,i.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,i.jsx)("h3",{className:"font-semibold text-gray-900 truncate",children:e.requester.display_name}),(0,i.jsxs)("p",{className:"text-sm text-gray-500",children:["@",e.requester.username]}),(0,i.jsx)("div",{className:"flex items-center mt-1",children:(0,i.jsxs)(g.C,{variant:"outline",className:"text-xs",children:["Seviye ",e.requester.level]})})]})]}),(0,i.jsxs)("div",{className:"text-sm text-gray-600 mb-4",children:[e.requester.school&&(0,i.jsx)("div",{children:e.requester.school}),(0,i.jsxs)("div",{className:"text-xs mt-2",children:[(0,_.SY)(e.created_at)," tarihinde istek g\xf6nderdi"]})]}),(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsxs)(f.z,{size:"sm",onClick:()=>P(e.requester_id,"accept"),className:"flex-1",children:[(0,i.jsx)(h,{className:"h-3 w-3 mr-1"}),"Kabul Et"]}),(0,i.jsx)(f.z,{size:"sm",variant:"outline",onClick:()=>P(e.requester_id,"reject"),children:(0,i.jsx)(y,{className:"h-3 w-3"})})]})]},e.id)})}),0===b.length&&(0,i.jsxs)("div",{className:"text-center py-12",children:[(0,i.jsx)(n.Z,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,i.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Bekleyen istek yok"}),(0,i.jsx)("p",{className:"text-gray-600",children:"Yeni arkadaşlık istekleri burada g\xf6r\xfcnecek."})]})]}),(0,i.jsxs)(j.nU,{value:"suggestions",className:"space-y-6",children:[(0,i.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:q.map(e=>{var s;return(0,i.jsxs)(t.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"card p-6",children:[(0,i.jsxs)("div",{className:"flex items-center space-x-4 mb-4",children:[(0,i.jsx)(v.q,{src:e.avatar_url,alt:e.display_name,fallback:null===(s=e.username[0])||void 0===s?void 0:s.toUpperCase(),size:"lg"}),(0,i.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,i.jsx)("h3",{className:"font-semibold text-gray-900 truncate",children:e.display_name}),(0,i.jsxs)("p",{className:"text-sm text-gray-500",children:["@",e.username]}),(0,i.jsx)("div",{className:"flex items-center mt-1",children:(0,i.jsxs)(g.C,{variant:"outline",className:"text-xs",children:["Seviye ",e.level]})})]})]}),e.compatibility_score&&e.compatibility_score>0&&(0,i.jsxs)("div",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium mb-3 ".concat(F(e.compatibility_score)),children:[(0,i.jsx)(m.Z,{className:"h-3 w-3 mr-1"}),"%",e.compatibility_score," uyumlu"]}),(0,i.jsxs)("div",{className:"space-y-2 text-sm text-gray-600 mb-4",children:[e.school&&(0,i.jsx)("div",{children:e.school}),e.city&&(0,i.jsx)("div",{children:e.city}),e.interests&&e.interests.length>0&&(0,i.jsx)("div",{className:"flex flex-wrap gap-1 mt-2",children:e.interests.slice(0,3).map(e=>(0,i.jsx)(g.C,{variant:"secondary",className:"text-xs",children:e},e))})]}),(0,i.jsxs)(f.z,{size:"sm",onClick:()=>P(e.id,"send"),className:"w-full",children:[(0,i.jsx)(p.Z,{className:"h-3 w-3 mr-1"}),"Arkadaş Ekle"]})]},e.id)})}),0===q.length&&(0,i.jsxs)("div",{className:"text-center py-12",children:[(0,i.jsx)(c.Z,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,i.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"\xd6neri bulunamadı"}),(0,i.jsx)("p",{className:"text-gray-600",children:"Şu anda yeni arkadaş \xf6nerisi bulunmuyor."})]})]})]})}}},function(e){e.O(0,[61,82,770,872,804,971,938,744],function(){return e(e.s=8595)}),_N_E=e.O()}]);